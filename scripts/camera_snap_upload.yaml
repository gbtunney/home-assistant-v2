#####
# SCRIPTS: Camera Snapshot and Upload
# https://www.home-assistant.io/integrations/script/
# https://www.home-assistant.io/docs/configuration/splitting_configuration/
#####
camera_snap_and_upload:
  alias: Camera Snapshot and Upload
  sequence:
    - variables:
        response: not set
        filename:
          "{% from 'camera.jinja' import snapshot_path %}{{ snapshot_path(
          entity | default('camera.camera_1_q5_profile1')  ) }}"
    - action: camera.snapshot
      metadata: {}
      data:
        filename: "{{ filename }}"
      target:
        entity_id: "{{entity | default('camera.camera_1_q5_profile1') }}"
    - action: google_photos.upload
      metadata: {}
      data:
        config_entry_id: 01JDXZWF95N644N5ACX8K3Q189
        filename: "{{ filename }}"
        album: Home Assistant Camera
      response_variable: response
    - action: persistent_notification.create
      metadata: {}
      data:
        title: Snapshot Success!
        message: "File was created at: {{ filename }}  Google Upload status: {{ response }}"
  description: >
    - Takes camera snapshot and saves
    - Uploads to google photos
    - Sends notification when completed '
  icon: mdi:camera-retake-outline
