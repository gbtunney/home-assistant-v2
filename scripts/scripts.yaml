#####
# SCRIPTS: General TODO: move below
# https://www.home-assistant.io/integrations/script/
# https://www.home-assistant.io/docs/configuration/splitting_configuration/
#####
aquarium_lights_on_for_15min:
  alias: Aquarium Lights (ON for 15min)
  sequence:
    - action: switch.turn_on
      metadata: {}
      data: {}
      target:
        entity_id: switch.fish_lights
    - delay:
        hours: 0
        minutes: "{{ states('input_number.light_minutes') | int}}"
        seconds: 0
        milliseconds: 0
    - if:
        - condition: state
          state: "off"
          entity_id: schedule.fish_lights_schedule
      then:
        - action: switch.turn_off
          metadata: {}
          data: {}
          target:
            entity_id: switch.fish_lights
    - action: input_number.set_value
      metadata: {}
      data:
        value: 15
      target:
        entity_id: input_number.light_minutes
    - action: logbook.log
      metadata: {}
      data:
        entity_id: script.20g_rest_pumps_45_min
        name: 20g Rest Pumps (minutes)
        message: Aquarium Lights Timer has ran successfully!
  description: ""
  icon: mdi:fish
20g_rest_pumps_45_min:
  alias: 20g Rest Pumps (45 min)
  sequence:
    - action: switch.turn_off
      metadata: {}
      data: {}
      target:
        entity_id:
          - switch.20_gallon_long_socket_4
          - switch.20_gallon_long_socket_2
          - switch.20_gallon_long_socket_3
    - delay: 0{{ state_attr('timer.pumps_off_delay','duration') }}
      enabled: false
    - delay:
        hours: 0
        minutes: "{{ states('input_number.rest_pumps_minutes') }}"
        milliseconds: 0
      enabled: true
    - action: switch.turn_on
      metadata: {}
      data: {}
      target:
        entity_id:
          - switch.20_gallon_long_socket_4
          - switch.20_gallon_long_socket_2
      alias: "Turn on pumps thing "
    - if:
        - condition: state
          entity_id: schedule.fish_co2_schedule
          state: "on"
      then:
        - action: switch.turn_on
          metadata: {}
          data: {}
          target:
            entity_id: switch.20_gallon_long_socket_3
      alias: Auto turn CO2 back on
    - action: input_number.set_value
      metadata: {}
      data:
        value: 45
      target:
        entity_id: input_number.rest_pumps_minutes
    - action: logbook.log
      metadata: {}
      data:
        entity_id: script.20g_rest_pumps_45_min
        name: 20g Rest Pumps
        message: Pump Rest Has Run Successfully!
  description: ""
  icon: mdi:fish-off
