# ============================================================
# DEVICE â€” ENV TEMP 1 (DEPLOYED)
# ============================================================
#
# This is a DEPLOYED device file.
# It lives at the root of the ESPHome config directory so it
# appears in the ESPHome add-on UI.
#
# Role:
# - Environmental temperature monitoring
# - 3 Dallas probe pairs
# - Bluetooth Proxy infrastructure
# - Standard diagnostics
#
# ============================================================

substitutions:
  log_level: VERY_VERBOSE
  device_use_address: "192.168.1.25"
  ble_proxy: false
  # ----------------------------------------------------------
  # DEVICE IDENTITY
  # ----------------------------------------------------------
  device_id: gbt_esp1
  device_hostname: "gbt-esp1"
  device_friendly_name: "ESP1 Environment Sensor"
  device_description: "Temperature monitor with BLE proxy"

  #-----------------------------------------------------
  # DALLAS BUS CONFIGURATION
  # ----------------------------------------------------------
  dallas_pin: "22"
  dallas_avg_window: "5"

  # ----------------------------------------------------------
  # PROBE ADDRESSES
  # ----------------------------------------------------------
  probe_1a_address: "0x8e00000038ab1428"
  probe_1b_address: "0x3a00000036e82128"

  probe_2a_address: "0x4c00000033fa6d28"
  probe_2b_address: "0x49000000370e6b28"

  probe_3a_address: "0x43000000340df728"
  probe_3b_address: "0x9d00000036c0df28"

packages:
  # ----------------------------------------------------------
  # BASE + FLEET
  # ----------------------------------------------------------
  base: !include common/universal_base.yaml
  board: !include common/platforms/esp32doit.yaml
  fleet:
    !include fleets/env_sensors.yaml

    # ----------------------------------------------------------
  # CAPABILITIES
  # ----------------------------------------------------------
  diagnostics: !include common/capabilities/diagnostics.yaml
  ble: !include common/capabilities/bluetooth_proxy.yaml
  dallas_bus: !include common/capabilities/dallas/bus.yaml

  # ----------------------------------------------------------
  # PROBE PAIRS (3 TOTAL)
  # ----------------------------------------------------------
  probe_pair_1:
    <<: !include
      file: common/capabilities/dallas/probe_pair.yaml
      vars:
        pair_id: "1"
        probe_a_address: ${probe_1a_address}
        probe_b_address: ${probe_1b_address}

  probe_pair_2:
    <<: !include
      file: common/capabilities/dallas/probe_pair.yaml
      vars:
        pair_id: "2"
        probe_a_address: ${probe_2a_address}
        probe_b_address: ${probe_2b_address}

  probe_pair_3:
    <<: !include
      file: common/capabilities/dallas/probe_pair.yaml
      vars:
        pair_id: "3"
        probe_a_address: ${probe_3a_address}
        probe_b_address: ${probe_3b_address}
captive_portal:
