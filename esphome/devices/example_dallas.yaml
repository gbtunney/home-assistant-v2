# ============================================================
# DEVICE â€” ENV TEMP 1 (DEPLOYED)
# ============================================================
#
# This is a DEPLOYED device file.
# It lives at the root of the ESPHome config directory so it
# appears in the ESPHome add-on UI.
#
# Role:
# - Environmental temperature monitoring
# - 3 Dallas probe pairs
# - Bluetooth Proxy infrastructure
# - Standard diagnostics
#
# ============================================================

substitutions:
  # ----------------------------------------------------------
  # DEVICE IDENTITY
  # ----------------------------------------------------------
  device_id: "env_temp_1"
  device_friendly_name: "Env Temp Node 1"
  device_description: "Rack temperature monitor with BLE proxy"

  # ----------------------------------------------------------
  # DALLAS BUS CONFIGURATION
  # ----------------------------------------------------------
  dallas_pin: "21"
  dallas_avg_window: "5"

  # ----------------------------------------------------------
  # PROBE ADDRESSES
  # ----------------------------------------------------------
  probe_1a_address: "0x28FFAAAA11111111"
  probe_1b_address: "0x28FFBBBB22222222"

  probe_2a_address: "0x28FFCCCC33333333"
  probe_2b_address: "0x28FFDDDD44444444"

  probe_3a_address: "0x28FFEEEE55555555"
  probe_3b_address: "0x28FFFFF666666666"

packages:
  # ----------------------------------------------------------
  # BASE + FLEET
  # ----------------------------------------------------------
  base: !include common/universal_base.yaml
  fleet: !include fleets/env_sensors.yaml

  # ----------------------------------------------------------
  # CAPABILITIES
  # ----------------------------------------------------------
  diagnostics: !include common/capabilities/diagnostics.yaml
  ble: !include common/capabilities/bluetooth_proxy.yaml
  dallas_bus: !include common/capabilities/dallas_bus.yaml

  # ----------------------------------------------------------
  # PROBE PAIRS (3 TOTAL)
  # ----------------------------------------------------------
  probe_pair_1:
    <<: !include
      file: common/dallas/probe_pair.yaml
      vars:
        pair_id: "1"
        probe_a_address: ${probe_1a_address}
        probe_b_address: ${probe_1b_address}

  probe_pair_2:
    <<: !include
      file: common/dallas/probe_pair.yaml
      vars:
        pair_id: "2"
        probe_a_address: ${probe_2a_address}
        probe_b_address: ${probe_2b_address}

  probe_pair_3:
    <<: !include
      file: common/dallas/probe_pair.yaml
      vars:
        pair_id: "3"
        probe_a_address: ${probe_3a_address}
        probe_b_address: ${probe_3b_address}
