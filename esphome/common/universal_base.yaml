# ============================================================
# UNIVERSAL BASE â€” PLATFORM CONTRACT
# ============================================================
#
# PURPOSE
# -------
# This file defines the *platform-level contract* shared by
# all ESPHome devices in this repo.
#
# It MAY define:
#   - device identity (name, friendly_name, comment)
#   - logging defaults
#   - API / OTA configuration
#   - WiFi + fallback AP
#   - project metadata (firmware family + version)
#
# It MUST NOT define:
#   - sensors, binary_sensors, buttons, switches
#   - hardware capabilities (BLE, Dallas, GPIO, etc.)
#   - fleet metadata (fleet_id, firmware version values)
#
# If it creates an ESPHome entity, it does NOT belong here.
#
# ------------------------------------------------------------

esphome:
  # Machine identifier (stable, never renamed)
  name: ${device_id}

  # Human-readable name (safe to change)
  friendly_name: ${device_friendly_name}

  # Freeform description of what this device does
  # (lives at device level)
  comment: ${device_description}

  # Firmware family metadata
  # NOTE:
  # - Values are PROVIDED by the fleet include
  # - This file may reference fleet substitutions
  # - This file must NEVER define fleet values itself
  project:
    name: "${fleet_id}"
    version: "${fleet_firmware_version}"

esp32:
  board: esp32dev
  framework:
    type: arduino

# ------------------------------------------------------------
# LOGGING
# ------------------------------------------------------------
# Logging is a platform concern.
# Log level is device-configurable via substitution.
logger:
  level: ${log_level}

# ------------------------------------------------------------
# API + OTA
# ------------------------------------------------------------
# Core lifecycle services shared by all devices.
api:
  id: ${device_id}_api
  encryption:
    key: !secret api_encryption_key

ota:
  - platform: esphome
    id: ${device_id}_ota
    password: !secret ota_password

# ------------------------------------------------------------
# WIFI + FALLBACK AP
# ------------------------------------------------------------
# WiFi configuration is universal and must not be duplicated
# in device or capability files.
wifi:
  id: ${device_id}_wifi
  ssid: !secret wifi_ssid
  password: !secret wifi_password

  # Fallback AP is required for recovery
  ap:
    ssid: "${device_friendly_name} Fallback"
    password: !secret fallback_ap_password

captive_portal:
